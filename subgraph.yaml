specVersion: 0.0.2
description: Swarm Contract Issuance
repository: https://github.com/my-swarm/subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Registry
    network: mainnet
    source:
      address: "0x0078371BDeDE8aAc7DeBfFf451B74c5EDB385Af7"
      abi: SRC20Registry
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/registry.ts
      abis:
        - name: SRC20Registry
          file: ./abis/SRC20Registry.json
      entities:
        - Registry
      eventHandlers:
        - event: SRC20Removed(address)
          handler: handleSRC20Removed
        - event: SRC20SupplyIncreased(address,address,uint256,uint256)
          handler: handleSupplyIncreased
        - event: SRC20SupplyDecreased(address,address,uint256,uint256)
          handler: handleSupplyDecreased

  - kind: ethereum/contract
    name: AssetRegistry
    network: mainnet
    source:
      address: "0x3619DbE27d7c1e7E91aA738697Ae7Bc5FC3eACA5"
      abi: AssetRegistry
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/assetRegistry.ts
      abis:
        - name: AssetRegistry
          file: ./abis/AssetRegistry.json
      entities:
        - AssetRegistry
      eventHandlers:
        - event: AssetAdded(indexed address,bytes32,string,uint256)
          handler: handleAssetAdded
        - event: NavUpdated(indexed address,uint256)
          handler: handleNavUpdated
        - event: KyaUpdated(indexed address,bytes32,string)
          handler: handleKyaUpdated

  - kind: ethereum/contract
    name: Factory
    network: mainnet
    source:
      address: "0xf4e77E5Da47AC3125140c470c71cBca77B5c638c"
      abi: SRC20Factory
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: ./src/mappings/factory.ts
      abis:
        - name: SRC20Factory
          file: ./abis/SRC20Factory.json
        - name: Features
          file: ./abis/Features.json
      entities:
        - Factory
        - Features
      eventHandlers:
        - event: SRC20Created(address,address,address,address,address,string,string,uint8,uint256)
          handler: handleSRC20Created


templates:
  - name: Token
    network: mainnet
    kind: ethereum/contract
    source:
      abi: SRC20
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: './src/mappings/token.ts'
      abis:
        - name: SRC20
          file: ./abis/SRC20.json
      entities:
        - Token
        - TokenHolder
        - Transfer
      eventHandlers:
        - event: FundraiserAdded(address)
          handler: handleFundraiserAdded
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer

  - name: TransferRules
    network: mainnet
    kind: ethereum/contract
    source:
      abi: TransferRules
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: './src/mappings/transferRules.ts'
      abis:
        - name: TransferRules
          file: ./abis/TransferRules.json
      entities:
        - Token
        - TransferRequest
      eventHandlers:
        - event: AccountWhitelisted(address,address)
          handler: handleWhitelisted
        - event: AccountUnWhitelisted(address,address)
          handler: handleUnWhitelisted
        - event: AccountGreylisted(address,address)
          handler: handleGreylisted
        - event: AccountUnGreylisted(address,address)
          handler: handleUnGreylisted
        - event: TransferRequested(indexed uint256,address,address,uint256)
          handler: handleTransferRequested
        - event: TransferApproved(indexed uint256,indexed address,indexed address,uint256)
          handler: handleTransferApproved
        - event: TransferDenied(indexed uint256,indexed address,indexed address,uint256)
          handler: handleTransferDenied

  - name: Features
    network: mainnet
    kind: ethereum/contract
    source:
      abi: Features
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: './src/mappings/features.ts'
      abis:
        - name: Features
          file: ./abis/Features.json
      entities:
        - Features
        - Token
        - TokenHolder
      eventHandlers:
        - event: FeaturesUpdated(bool,bool,bool,bool)
          handler: handleFeaturesUpdated
        - event: AccountFrozen(indexed address)
          handler: handleAccountFrozen
        - event: AccountUnfrozen(indexed address)
          handler: handleAccountUnfrozen
        - event: Paused(address)
          handler: handleTokenFrozen
        - event: Unpaused(address)
          handler: handleTokenUnfrozen


  - name: Fundraiser
    network: mainnet
    kind: ethereum/contract
    source:
      abi: Fundraiser
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      file: './src/mappings/fundraiser.ts'
      abis:
        - name: Fundraiser
          file: ./abis/Fundraiser.json
        - name: ERC20
          file: ./abis/ERC20.json
      entities:
        - Fundraiser
        - ERC20
      eventHandlers:
        - event: FundraiserSetup(address,uint256,address,address,address,bool)
          handler: handleFundraiserSetup
        - event: FundraiserFinished()
          handler: handleFundraiserFinished
        - event: FundraiserCanceled()
          handler: handleFundraiserCanceled
        - event: ContributionPending(indexed address,uint256)
          handler: handleContributionPending
        - event: ContributionAdded(indexed address,uint256)
          handler: handleContributionAdded
        - event: PendingContributionAccepted(indexed address,uint256)
          handler: handlePendingContributionAccepted
        - event: ContributorAccepted(address)
          handler: handleContributorAccepted
        - event: ContributorRemoved(address,bool)
          handler: handleContributorRemoved

#    event ContributionRefunded(indexed address,uint256)
#    event ContributorAccepted(address)
#    event TokensClaimed(indexed address,uint256)
#    event FundsWithdrawal(indexed address,uint256)
#    event ReferralCollected(indexed address,uint256)
